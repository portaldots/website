---
title: コアサーバーに PortalDotsをインストールする
description: コアサーバーに PortalDotsをインストールする方法をご説明します。
priority: 2
---

<docs-alert type="info">
  このページでは、2021年5月末リリース予定の PortalDots 3 について説明しています。PortalDots 1 はさくらのレンタルサーバーでのみ動作します。
</docs-alert>

## 「コアサーバー」で PortalDots を利用する際の留意点

- 「コアサーバー」は比較的高機能なレンタルサーバーです。メールサポートはありますが、ある程度のサーバー運用の知識が必要になります。サーバー運用に自信がない場合は、他のレンタルサーバーの利用をご検討ください。
- 「コアサーバー」では、利用料金の支払いにクレジットカード決済のほか、銀行振替やコンビニ決済が利用できます。
- 「コアサーバー」の利用には、「バリュードメイン」のユーザーアカウントを作成する必要があります。また「コアサーバー」の利用料金の支払いは、「バリュードメイン」の画面上で行います。
- 「お知らせ」の検索機能はコアサーバーでは利用できません。検索機能を利用したい場合、MySQL 5.7 以上に対応した他のレンタルサーバーの利用をご検討ください。

## このページで説明する内容

- FTP接続ソフトとして Cyberduck を使用する前提で説明します。
- レンタルサーバー申し込み時に決める URL を、PortalDots の URL としてそのまま利用する前提で説明します。
    - 独自ドメインを利用したい場合のセットアップ方法は、このページでは説明しません。
- PortalDots から自動配信するメールの差出人のメールアドレスをカスタマイズしたい場合のセットアップ方法は、このページでは説明しません。
- PortalDots は、学校から学生に対し発行されるメールアドレスの形式が「学籍番号@固定のドメイン」の場合のみ利用できます。
    - 例えば東京理科大学の場合は「固定のドメイン」が「ed.tus.ac.jp」となっており、利用可能です。「@」より前に任意の文字列を設定できる学校、または学生により「@」より後の文字列が異なる学校、「@」より前の文字列において、小文字・大文字の区別がある学校では PortalDots は利用できません（将来的には、これらの学校でも利用できるようにする予定です）。

<docs-alert type="info">
  「@」より前に任意の文字列を設定できる学校でも、一応の利用は可能です。その場合、参加企画に対しては次のように説明してください : 「ウェブシステム上では『学籍番号』と表示されていますが、この入力欄には、学校発行メールアドレスの『@』より前の文字列を入力してください。」
</docs-alert>

## 1. コアサーバーに申し込む（無料お試しあり）

※無料お試しは、お支払い方法の入力は不要です。

1. コアサーバーの「[お申込みとその流れ](https://www.coreserver.jp/signup/)」ページに掲載されている申し込み方法に従って、コアサーバーに申し込みます。
    - CORE-X(ライトプラン)、CORE-Y(スタンダードプラン)、CORE-Z(ビジネスプラン)いずれでもPortalDotsは動作します。特に希望がない場合は、一番安価なCORE-X(ライトプラン)をお勧めします。
    - 支払い方法に関しても「お申込みとその流れ」ページに掲載されていますのでご確認ください。
2. コアサーバーへの申し込みが完了したら、次の「2. データベースを作成する」へ進みます
    - コアサーバーのコントロールパネルにログインするための「アカウント名」「パスワード」「サーバー」は、申込み時に届くメール（件名 : CORESERVER.JP NEW SIGNUP）に掲載されています。

<docs-alert type="warning">
  パスワードの使い回しや複数人での共有は危険です。<br>PortalDots上ではユーザーの個人情報を多く扱うことになります。コアサーバーのパスワードが漏洩すると、ユーザーの個人情報が流出する恐れがありますので、パスワードの取り扱いには十分ご注意ください。
</docs-alert>

## 2. データベースを作成する

PortalDots 上に保存するデータ（ユーザー情報や参加企画情報など）は、データベース上に保存されます。PortalDots のインストール前に、あらかじめデータベースを作成しておきます。

1. コアサーバーのコントロールパネルにログインします
    - 申込み時に届くメールに掲載されている「アカウント名」「パスワード」「サーバー」でログインできます。
2. 画面左のメニューから「データベース」をクリックします
3. 「新しいデータベースを作成」ボタンをクリックします
4. 「データベース名」と「データベースパスワード」は任意のものを設定します。「データベース名」と「データベースユーザ」は同じもので構いません。ここで入力した「**データベース名**」と「**データベースユーザ**」、「**データベースパスワード**」は、PortalDots をインストールする際に必要です。
5. 「データベースを作成」ボタンをクリックします。
6. 「DATABASE CREATED」という画面が表示されます。この画面内に表示されている「**Database**」、「**Host**」、「**Username**」、「**Password**」を確認、メモしてください。これらの情報は、PortalDots をインストールする際に必要です。

<docs-alert type="warning">
  「データベースパスワード」は、他の用途で利用していないパスワードを設定してください。このパスワードが漏洩すると、PortalDots に保存されたユーザー情報が全て漏洩します。必ずランダムな文字列をパスワードとして設定してください。
</docs-alert>

## 3. メールアカウントを作成する

PortalDots では、ユーザーへメールを自動送信するために、コアサーバーのメールサーバー情報が必要になります。PortalDots からのメルマガの配信を予定していない場合でも、メールサーバーの設定は必須です。

1. コアサーバーのコントロールパネルにログインします
2. 画面左のメニューから「メール」をクリックします
3. 「アカウントを作成」をクリックします
4. 「ユーザー名」の入力欄では、PortalDots から送信されるメールの差出人の、「@」より前の文字列を設定できます。「パスワード」は任意のものを設定します。「Eメールのクォータ」はデフォルト値で構いません。「送信数を制限」では、「無制限」にチェックを入れます。
    - 特に希望がない場合、「ユーザー名」は「portal」がお勧めです。
5. 「アカウントを作成」をクリックします。
6. 「ACCOUNT CREATED」という画面が表示されます。この画面内に表示されている「**Username**」、「**Password**」、「**SMTP Server**」、「**port**」を確認、メモしてください。これらの情報は、PortalDots をインストールする際に必要です。

<docs-alert type="warning">
  「パスワード」は、他の用途で利用していないパスワードを設定してください。このパスワードが漏洩すると、第三者が PortalDots のシステムになりすましてメールを送信することが可能になります。必ずランダムな文字列をパスワードとして設定してください。
</docs-alert>

## 4. 通信を暗号化するためにSSLを設定する(無料)

PortalDots では参加企画のメンバーの個人情報などを扱うことになります。通信が傍受されると情報漏洩のリスクがあるため、SSL証明書を設定します。ここでは、無料のSSL証明書(Let's Encrypt)を利用します。

1. コアサーバーのコントロールパネルにログインします
2. [https://www.coreserver.jp/support/manual/security-free-ssl-v2.php](https://www.coreserver.jp/support/manual/security-free-ssl-v2.php) に記載されている方法に従い、SSLを有効化してください。

## 5. PortalDots をサーバーにアップロードする

<docs-alert type="info">
  ブラウザ上で利用できる「ファイルマネージャー」では PortalDots をアップロードできません
</docs-alert>

1. コアサーバー申込み時に届くメール（件名 : CORESERVER.JP NEW SIGNUP）に記載されている「**アカウント名(FTPユーザー名)**」「**パスワード**」「**ＦＴＰサーバー**」を確認、メモします。
2. FTPソフトでFTP接続します。FTPソフトをインストールしていない場合、Cyberduckがお勧めです。設定方法はコアサーバーのマニュアルページに掲載されています([Cyberduckの設定方法](https://www.coreserver.jp/support/manual/cyberduck.php))。
    - Cyberduck の場合、「環境設定」内の「ブラウザ」タブにある「'.'で始まるファイルを表示」にチェックを入れてください
      ![Cyberduck 環境設定](/docs-images/cyberduck-settings-dotfile.png)
3. Cyberduckの画面上の「public_html」フォルダをダブルクリックして開きます。
4. 初期状態ではいくつかのファイルが設置されています。これらは不要なため、ファイル上で右クリックして削除します。
5. PortalDots.zip をダウンロードし、展開します。
6. 展開してできたフォルダの中身を全て「public_html」フォルダ内へアップロードします。Cyberduckの場合、Finder(macOSの場合)またはエクスプローラー(Windowsの場合)からファイルをドラッグ&ドロップしてください。
    - 隠しファイル(ドットで始まるファイル)も含めてアップロードしてください。macOS や Linux などの OS では、デフォルトではこれらのファイルは非表示になっています。macOS の場合、Finder で <docs-kbd>Command</docs-kbd> + <docs-kbd>Shift</docs-kbd> + <docs-kbd>.</docs-kbd> を押すと隠しファイルが表示されます。
      ![Cyberduck でファイルをアップロードする](/docs-images/cyberduck-drag-and-drop.png)
7. アップロードには5分〜10分程度時間がかかりますので、お待ちください。
8. アップロードが完了したら、コアサーバーのコントロールパネルにログインします。
9. 画面左のメニューから「ドメイン」をクリックします。
10. ドメイン一覧の表に記載されている「〇〇.△△.coreserver.jp」という形式のURLを確認、メモします。
11. 先ほど確認したURLの先頭に「https://」をつけたURLにアクセスしてください。
    - 先ほど確認したURLが「〇〇.△△.coreserver.jp」の場合、「 https://〇〇.△△.coreserver.jp 」にアクセスしてください。
12. 「PortalDots へようこそ！」という画面が表示されたら、アップロード完了です。

![「PortalDotsへようこそ！」画面](/docs-images/setup-installer-welcome.png)

## 6. PortalDots のインストール作業を進める

「PortalDots へようこそ！」画面にある「設定をはじめる」をクリックします。

### 6.1. 「ポータルの情報」設定

![「ポータルの情報」設定](/docs-images/setup-installer-step1.png)

「ポータルの情報」画面では、以下のように設定します。

- 「ポータルの名前」にはウェブシステムの名前を設定します。例えば「野田祭ウェブシステム」など、「〇〇祭ウェブシステム」という名前がお勧めです。
- 「ポータルのURL」には、「5. PortalDots をサーバーにアップロードする」で確認したURLの先頭に、「https://」を追加したものを入力してください。確認したURLが「〇〇.△△.coreserver.jp」の場合、「ポータルのURL」には「 https://〇〇.△△.coreserver.jp 」と入力してください。
- 「https接続を強制する」にチェックを入れます。
- 「実行委員会の名称」には、学園祭実行委員会の名称を入力します。ここで入力された名前は、PortalDots から送信されるメールの文面など、PortalDots の画面上に表示されます。
- 「実行委員会のメールアドレス」には、学園祭参加企画からのお問い合わせを受け付けるメールアドレスを入力します。PortalDots から送信された「お問い合わせ」はこのメールアドレスに届くほか、PortalDots から送信されるメールの文面など、PortalDots の画面上に表示されます。
- 「学校発行メールアドレスのドメイン」には、学校が学生に配布・発行しているメールアドレスの「@」より後の文字列を入力します。
    - PortalDots は、学校から学生に対し発行されるメールアドレスの形式が「学籍番号@固定のドメイン」の場合のみ利用できます。
        - 例えば東京理科大学の場合は「固定のドメイン」が「ed.tus.ac.jp」となっており、利用可能です。「@」より前に任意の文字列を設定できる学校、または学生により「@」より後の文字列が異なる学校、「@」より前の文字列において、小文字・大文字の区別がある学校では PortalDots は利用できません（将来的には、これらの学校でも利用できるようにする予定です）。

<docs-alert type="info">
  「@」より前に任意の文字列を設定できる学校でも、一応の利用は可能です。その場合、参加企画に対しては次のように説明してください : 「ウェブシステム上では『学籍番号』と表示されていますが、この入力欄には、学校発行メールアドレスの『@』より前の文字列を入力してください。」
</docs-alert>

### 6.2. 「MySQL データベース設定」

![「MySQL データベース設定」](/docs-images/setup-installer-step2.png)

「MySQL データベース設定」で「2. データベースを作成する」でメモした情報を入力します。

- 「データベースのホスト名」には、メモした「Host」を入力します。
- 「ポート番号」には、半角数字で「3306」を入力します。
- 「データベース名」には、メモした「Database」を入力します。
- 「ユーザー名」には、メモした「Username」を入力します。
- 「パスワード」には、メモした「Password」を入力します。

### 6.3. 「メール配信設定」

![「メール配信設定」設定](/docs-images/setup-installer-step3.png)

1. 「メール配信設定」で「3. メールアカウントを作成する」でメモした情報を入力します。
    - 「メールサーバー(SMTP)のホスト」には、メモした「SMTP Server」を入力します。
    - 「メールサーバー(SMTP)のポート」には、メモした「port」(半角数字)を入力します。
    - 「メールユーザー名」には、メモした「Username」を入力します。
    - 「メールパスワード」には、メモした「Password」を入力します。
    - 「PortalDotsから配信されるメールの差出人メールアドレス」には、メモした「Username」を入力します。
    - 「PortalDotsから配信されるメールの差出人の名前」には任意の文字列を設定できます。ウェブシステムの名前や実行委員会の名前にするのがお勧めです。ここで設定した名前は、PortalDots から送信されるメールをユーザーが確認する際、メールアプリの「差出人」欄に表示されます。
2. 「保存して次へ」をクリックすると、先ほど設定した「実行委員会のメールアドレス」に対してテストメールが送信されます。

### 6.4. 「管理者ユーザーの設定」

![「管理者ユーザーの設定」](/docs-images/setup-installer-step4.png)

1. 「管理者ユーザーの設定」で、PortalDots の管理者ユーザーを作成します。あなた自身の情報を入力してください。
2. 「登録してインストール実行」をクリックすると、データベース上に PortalDots 関連データの保存領域が作成され、管理者ユーザー情報がデータベース上に保存されます。
3. 「メール確認」ページが表示されます。「学校発行メールアドレス」と「連絡先メールアドレス」それぞれに1通ずつ確認メールが送信されます。それぞれのメールに記載された URL にアクセスしてください。
    ![「メール確認」ページ」](/docs-images/setup-installer-done.png)
4. 2通の URL にアクセスしたら、インストール完了です！

## 7. メールの一斉配信機能のセットアップ(CRONの設定)

「お知らせ」をユーザー全員に一斉配信するためには、CRONの設定が必要です。

1. コアサーバーのコントロールパネルにログインします
2. 画面左のメニューから「ツール」をクリックします
3. 画面左側のメニューから「CRONジョブ」をクリックします
4. 「CRONジョブを作成」ボタンをクリックします
5. 「分」に「\*/10」と入力、「時間」「日」「月」「曜日」には「\*」と入力してください
6. 「コマンド」には `/usr/local/bin/php /home/〇〇/public_html/artisan schedule:run` と入力してください
    - 〇〇の部分には、コアサーバーのコントロールパネルの画面右上に表示されている「アカウント」を入れてください。（以下の画像の〇〇の部分です）
      ![コアサーバーのアカウント名を確認する方法](/docs-images/coreserver-server-url.png)
7. 「作成」ボタンをクリックします
8. 以上でCRON設定は完了です。「お知らせ」の一斉配信機能が利用可能になります。

## こんなときはどうする？

### インストール中にエラーが発生したとき

- 「MySQL データベース設定」や「メール配信設定」をしようとしてもエラーになる場合、入力したパスワードなどが間違っていないかご確認ください。
    - 「データベースパスワード」と「メールパスワード」は、通常異なるパスワードです。「データベースパスワード」を入力するべきところ「メールパスワード」を入力してしまっているなど、パスワードの入力に誤りがないかご確認ください。
- 「ポータルの情報」設定で設定した「実行委員会のメールアドレス」によっては、「メール配信設定」時にエラーとなることがあります。その場合は、一度「ポータルの情報」設定に戻り、違う「実行委員会のメールアドレス」を設定してみてください。

### 「ポータルの情報」を設定後、PortalDotsにアクセスできなくなった時

SSLの設定をしていない状態で、「ポータルの情報」設定の「https接続を強制する」にチェックを入れると、PortalDotsにアクセスできなくなります。

- SSLの設定をしたにも関わらずPortalDotsにアクセスできなくなった場合、サーバー側のSSL設定の処理が完了していない可能性があります。しばらく待ってから再度PortalDotsにアクセスしてください。
- SSLの設定をしていない場合、「4. 通信を暗号化するためにSSLを設定する(無料)」に従ってSSLの設定をした後、しばらく待ってから再度PortalDotsにアクセスしてください。
